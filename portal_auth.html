<!DOCTYPE HTML>
<html>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<body>
<h1>Welcome to Phoenix Friend School Admissions</h1>
<h2>enter username and password to enter admin site:</h2>

<button type='button' id='gen' onclick='gen_sha()'>Generate Hash</button>
<br>
<form action="/cgi-bin/admin_manager.pl">
  <label for="username">username:</label><br>
  <input type="text" id="username" name="username" value=""><br>
  <label for="password">password:</label><br>
  <input type="text" id="password" name="password" value=""><br><br>
  <input id='form_submit' style='display: none;' type="submit" value="Submit">
</form> 

</body>
<script src="crypto.js"></script>
<script>

async function gen_sha(){

	let pwd = document.getElementById('password').value;
	console.log('raw pw: ' + pwd);
	const pwd_buffer = new TextEncoder().encode(pwd);

	await crypto.subtle.digest('SHA-256', pwd_buffer).then((hashed_pw_buf) => {
		let hashed_pw_hex = buf2hex(hashed_pw_buf);
		console.log('hashed pw: ' + hashed_pw_hex);
		document.getElementById('password').value = hashed_pw_hex;
	});
	document.getElementById('form_submit').style.display = 'inline';
}

</script>

</html>
